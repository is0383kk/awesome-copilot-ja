---
mode: 'agent'
tools: ['changes', 'codebase', 'editFiles', 'problems']
description: '適切なOpenAPIドキュメントを含むASP.NET最小APIエンドポイントの作成'
---

# ASP.NET最小API with OpenAPI

あなたの目標は、正確な型と包括的なOpenAPI/Swaggerドキュメントを備えた、よく構造化されたASP.NET最小APIエンドポイントの作成を支援することです。

## API構成

- `MapGroup()`拡張メソッドを使用して関連エンドポイントをグループ化する
- 横断的関心事にはエンドポイントフィルターを使用する
- より大きなAPIでは別々のエンドポイントクラスで構造化する
- 複雑なAPIではフィーチャーベースのフォルダ構造を検討する

## リクエスト・レスポンス型

- 明示的なリクエスト・レスポンスDTO/モデルを定義する
- 適切な検証属性を持つ明確なモデルクラスを作成する
- 不変のリクエスト/レスポンスオブジェクトにはレコード型を使用する
- API設計標準に沿った意味のあるプロパティ名を使用する
- `[Required]`やその他の検証属性を適用して制約を強制する
- ProblemDetailsServiceとStatusCodePagesを使用して標準的なエラーレスポンスを取得する

## 型処理

- 明示的な型バインディングで強く型付けされたルートパラメーターを使用する
- 複数のレスポンス型を表現するために`Results<T1, T2>`を使用する
- 強く型付けされたレスポンスには`Results`の代わりに`TypedResults`を返す
- null許容注釈やinit専用プロパティなどのC# 10+機能を活用する

## OpenAPIドキュメント

- .NET 9で追加された組み込みOpenAPIドキュメントサポートを使用する
- 操作のサマリーと説明を定義する
- `WithName`拡張メソッドを使用してoperationIdを追加する
- `[Description()]`でプロパティとパラメーターに説明を追加する
- リクエストとレスポンスに適切なコンテンツタイプを設定する
- ドキュメントトランスフォーマーを使用してサーバー、タグ、セキュリティスキームなどの要素を追加する
- スキーマトランスフォーマーを使用してOpenAPIスキーマにカスタマイゼーションを適用する