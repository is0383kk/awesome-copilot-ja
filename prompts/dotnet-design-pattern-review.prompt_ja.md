---
mode: 'agent'
description: 'C#/.NET コードのデザインパターン実装をレビューし、改善を提案する。'
---
# .NET/C# デザインパターンレビュー

${selection} 内の C#/.NET コードのデザインパターン実装をレビューし、ソリューション/プロジェクトの改善を提案します。コードに変更を加えず、レビューのみを提供してください。

## 必要なデザインパターン

- **コマンドパターン**: ジェネリック基底クラス（`CommandHandler<TOptions>`）、`ICommandHandler<TOptions>` インターフェース、`CommandHandlerOptions` 継承、静的 `SetupCommand(IHost host)` メソッド
- **ファクトリーパターン**: 複雑なオブジェクト生成サービスプロバイダー統合
- **依存性注入**: プライマリコンストラクター構文、`ArgumentNullException` null チェック、インターフェース抽象化、適切なサービスライフタイム
- **リポジトリパターン**: 非同期データアクセスインターフェース接続のプロバイダー抽象化
- **プロバイダーパターン**: 外部サービス抽象化（データベース、AI）、明確な契約、構成処理
- **リソースパターン**: ローカライズされたメッセージのための ResourceManager、別々の .resx ファイル（LogMessages、ErrorMessages）

## レビューチェックリスト

- **デザインパターン**: 使用されているパターンを特定。コマンドハンドラー、ファクトリー、プロバイダー、リポジトリパターンは正しく実装されているか？有益なパターンが欠けていないか？
- **アーキテクチャ**: 名前空間規約（`{Core|Console|App|Service}.{Feature}`）に従っているか？Core/Console プロジェクト間の適切な分離？モジュラーで読みやすいか？
- **.NET ベストプラクティス**: プライマリコンストラクター、Task を返す async/await、ResourceManager の使用、構造化ログ、強く型付けされた構成？
- **GoF パターン**: コマンド、ファクトリー、テンプレートメソッド、ストラテジーパターンは正しく実装されているか？
- **SOLID 原則**: 単一責任、オープン・クローズド、リスコフ置換、インターフェース分離、依存関係逆転の違反？
- **パフォーマンス**: 適切な async/await、リソース廃棄、ConfigureAwait(false)、並列処理の機会？
- **保守性**: 関心の明確な分離、一貫したエラーハンドリング、適切な構成使用？
- **テスト可能性**: インターフェースによる依存関係抽象化、モック可能なコンポーネント、非同期テスト可能性、AAA パターン互換性？
- **セキュリティ**: 入力検証、セキュアな認証情報処理、パラメーター化クエリ、安全な例外処理？
- **ドキュメント**: パブリック API の XML ドキュメント、パラメーター/戻り値の説明、リソースファイル組織？
- **コードの明確性**: ドメイン概念を反映する意味のある名前、パターンによる明確な意図、自明な構造？
- **クリーンコード**: 一貫したスタイル、適切なメソッド/クラスサイズ、最小限の複雑性、重複の排除？

## 改善フォーカスエリア

- **コマンドハンドラー**: 基底クラスでの検証、一貫したエラーハンドリング、適切なリソース管理
- **ファクトリー**: 依存関係構成、サービスプロバイダー統合、廃棄パターン
- **プロバイダー**: 接続管理、非同期パターン、例外処理とログ
- **構成**: データアノテーション、検証属性、機密値のセキュア処理
- **AI/ML 統合**: Semantic Kernel パターン、構造化出力処理、モデル構成

プロジェクトのアーキテクチャと .NET ベストプラクティスに沿った、具体的で実行可能な改善推奨事項を提供してください。